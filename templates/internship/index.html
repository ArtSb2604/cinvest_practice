{% load static %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Стажировка в Банк Центр-инвест</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link data-n-head="ssr" rel="icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}">
</head>
<body>
<header>
    <div class="logo">
        <img src="{% static 'img/logo.svg' %}" alt="Банк Центр-инвест">
    </div>
    <div class="catalog">
        <nav>Направления</nav>
        <nav>Условия</nav>
        <nav>Отбор</nav>
    </div>
    <div class="statement">
        <button onclick="switchOpen()">Подать заявку</button>
    </div>
</header>
<main>
    <div class="header-promo">
        <img src="{% static 'img/header_prom.png' %}" alt="">
    </div>
    <section class="info">
        <div class="info-statement">
            Стажировка в Банк Центр-инвест
            <div class="applic">
                <a id="modal-open" onclick="switchOpen()">Подать заявку</a>
            </div>
        </div>
    </section>
    <section class="info-set_container">
        <div class="info-set">
            <div>Открыт осенний набор на оплачиваемую стажировку. Подавайте заявки!</div>
        </div>
        <nav class="info-category">
            {% for i in DirectionsDesc %}
                <nav onclick="render('{{ i.data_menu }}')" data-menu="{{ i.data_menu }}" id="btn">{{ i.title }}</nav>
            {% endfor %}
        </nav>
        <div data-menu="ios" id="list" class="container_info-category-detailed">
            {% for i in Directions %}
                {% if i.data_menu == 'ios' %}
                    <div class="info-category-detailed" onclick="switchFormOpen()">{{ i.directions_name }}</div>
                {% endif %}
            {% endfor %}
        </div>
        </div>
        <div data-menu="sis" id="list" class="container_info-category-detailed">
            {% for i in Directions %}
                {% if i.data_menu == 'sis' %}
                    <div class="info-category-detailed" onclick="switchFormOpen()">{{ i.directions_name }}</div>
                {% endif %}
            {% endfor %}
        </div>
        <div data-menu="admin" id="list" class="container_info-category-detailed">
            {% for i in Directions %}
                {% if i.data_menu == 'admin' %}
                    <div class="info-category-detailed" onclick="switchFormOpen()">{{ i.directions_name }}</div>
                {% endif %}
            {% endfor %}
        </div>
        <div data-menu="bd" id="list" class="container_info-category-detailed">
            {% for i in Directions %}
                {% if i.data_menu == 'bd' %}
                    <div class="info-category-detailed" onclick="switchFormOpen()">{{ i.directions_name }}</div>
                {% endif %}
            {% endfor %}
        </div>
        <div class="main_prom">
            <img src="{% static 'img/main_prom.png' %}" alt="">
        </div>
    </section>
    <section class="info-skill">
        {% for i in TitleMain %}
            <h1>{{ i.header }}</h1>
            <div>{{ i.main_title }}</div>
        {% endfor %}
    </section>
    <div class="fotter_promo">
        <img src="{% static 'img/fotter_prom.png' %}" alt="">
    </div>

    <div class="fixed-overlay fixed-overlay__modal" id="modal">
        <div class="modal">
            <div class="modal_container">
                <div class="lc-modal__close" aria-label="Закрыть" onclick="switchOpen()"></div>
                <h1>Выберите направление</h1>
                <div class="cat-modal">
                    <div class="modal-f">

                        <div onclick="switchFormOpen()" class="text">iOS разработчик ></div>
                    </div>
                </div>
                <div class="cat-modal">
                    <div class="modal-f">

                        <div onclick="switchFormOpen()" class="text">Системный аналитик ></div>
                    </div>
                </div>
                <div class="cat-modal">
                    <div class="modal-f">
                        <div onclick="switchFormOpen()" class="text">Администратор баз данных ></div>
                    </div>
                </div>
                <div class="cat-modal">
                    <div class="modal-f">
                        <div onclick="switchFormOpen()" class="text">Разработчик баз данных ></div>
                    </div>
                </div>
                <div class="modal_back"><img src="{% static 'img/modal.webp' %}" alt=""></div>
                <div class="modal_after"><img src="{% static 'img/modal_after.webp' %}" alt=""></div>
            </div>
        </div>
    </div>
    <div class="fixed-overlay fixed-overlay__form" id="form_modal">
        <div class="forms">
            <div class="form_container">
                <div class="lc-form__close" aria-label="Закрыть" onclick="switchFormOpen()"></div>
                <h1 class="text_form">Стажировка 2023</h1>
                <form id="forms">
                    <div class="input">
                        <label>Имя пользователя:</label>
                        <label>
                            <input required name="username"/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Фамилия:</label>
                        <label>
                            <input required name="first_name"/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Имя:</label>
                        <label>
                            <input required name="last_name"/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Отчество:</label>
                        <label>
                            <input required name="patronymic"/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Дата рождения:</label>
                        <label>
                            <input required type="date" class="user-input-birthdate user-input" name="birthdate">
                        </label>
                    </div>
                    <div class="input">
                        <label>Город:</label>
                        <label>
                            <input required name="city"/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Номер телефона:</label>
                        <label>
                            <input required name="number_phone"/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Почта:</label>
                        <label>
                            <input type="email" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
                                   name="email"/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Контакт для оперативной связи:</label>
                        <label>
                            <input name="social_contact" required/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Укажите вашу ступень обучения:</label>
                        <label>
                            <textarea name="course" required></textarea>
                        </label>
                    </div>
                    <div class="input">
                        <label>Расскажите, какого университета:</label>
                        <label>
                            <textarea name="university" required></textarea>
                        </label>
                    </div>
                    <div class="input">
                        <label>Кафедра:</label>
                        <label>
                            <input name="department" required/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Специальность:</label>
                        <label>
                            <input name="specialization" required/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Укажите год окончания:</label>
                        <label>
                            <input name="year_graduation" required/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Укажите ваш средний балл в вузе:</label>
                        <label>
                            <input name="average_score" required/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Расскажите о своих учебных интересах:</label>
                        <label>
                            <input name="educational_interests" required/>
                        </label>
                    </div>
                    <div class="input">
                        <label>Опишите, какими задачами вам было бы интересно заниматься во время стажировки:</label>
                        <label>
                            <textarea name="what_tasks" required></textarea>
                        </label>
                    </div>
                    <div class="input">
                        <label>Расскажите о своих достижениях:</label>
                        <label>
                            <textarea name="achievements" required></textarea>
                        </label>
                    </div>
                    <div class="input">
                        <label>Если у вас есть опыт работы/стажировки, расскажите об этом подробнее:</label>
                        <label>
                            <textarea name="work_experience" required></textarea>
                        </label>
                    </div>
                    <div class="input">
                        <label>Откуда вы узнали о стажировках в Банке Центр-Инвест:</label>
                        <label>
                            <textarea name="find_out" required></textarea>
                        </label>
                    </div>
                    <div class="input">
                        <label>Почему вас заинтересовала стажировка в Банке Центр-Инвест, и чего вы от неё
                            ждёте:</label>
                        <textarea name="interested_internship" required></textarea>
                    </div>
                    <button class="btn" type="submit" id="submit-btn">Отправить</button>
                </form>
            </div>
        </div>
    </div>
</main>
<script src="{% static 'js/nav_active.js' %}"></script>
<script src="{% static 'js/modal.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>
<script>

    const forms = document.getElementById('forms');
    const submitBtn = forms.querySelector('#submit-btn')


    const getFormValue = async event => {
        event.preventDefault();

        submitBtn.disabled = true

        const data = [...event.target].map(({name, value}) => [name, value]).reduce((data, input, currentIndex) => {
            if (currentIndex === 1) return {[data[0]]: data[1], [input[0]]: input[1]}
            return {...data, [input[0]]: input[1]}
        })


        await axios.post('/api/v1/users/create/', data).catch(err => {
            submitBtn.disabled = false
            console.log('Я *******, потому что ', err)
        })

        submitBtn.disabled = false


        switchFormOpen()
    }

    forms.addEventListener('submit', getFormValue);

</script>
</body>
</html>